# ESBuild é™åˆ¶å’Œè§£å†³æ–¹æ¡ˆ

## ğŸš¨ é—®é¢˜æè¿°

åœ¨è¿è¡Œ `npm run config:platform` æ—¶ï¼Œä½ é‡åˆ°äº†æ„å»ºé”™è¯¯ã€‚è¿™ä¸ªé”™è¯¯æ­ç¤ºäº† ESBuild çš„ä¸€ä¸ªé‡è¦é™åˆ¶ã€‚

## âŒ é”™è¯¯åŸå› 

ESBuild æ— æ³•å°†ç°ä»£ JavaScript è¯­æ³•è½¬æ¢åˆ° ES5ï¼ŒåŒ…æ‹¬ï¼š

- `const` å’Œ `let` å£°æ˜
- ç®­å¤´å‡½æ•° `() => {}`
- æ¨¡æ¿å­—ç¬¦ä¸² `` `${variable}` ``
- è§£æ„èµ‹å€¼ `const { a, b } = obj`
- å±•å¼€è¿ç®—ç¬¦ `[...array]`
- async/await
- é»˜è®¤å‚æ•° `function(a = 1) {}`

### é”™è¯¯ç¤ºä¾‹
```javascript
// âŒ ESBuild æ— æ³•å°†è¿™äº›è¯­æ³•è½¬æ¢åˆ° ES5
const numbers = [1, 2, 3];
const process = (nums) => nums.map(n => n * 2);
const { sum, average } = calculateStats(numbers);
```

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: ä½¿ç”¨ ES2017+ ç›®æ ‡ï¼ˆæ¨èï¼‰
```javascript
// ä¿®æ”¹å‰ï¼štarget: ['es5']
// ä¿®æ”¹åï¼štarget: ['es2017']

const config = {
  target: ['es2017'], // ESBuild æ”¯æŒçš„æœ€ä½ç‰ˆæœ¬
  // æˆ–è€…
  target: ['es2020', 'chrome90', 'firefox88'] // ç°ä»£æµè§ˆå™¨
};
```

### æ–¹æ¡ˆ2: ç¼–å†™ ES5 å…¼å®¹ä»£ç 
```javascript
// âœ… ES5 å…¼å®¹çš„ä»£ç 
var numbers = [1, 2, 3];

function processNumbers(nums) {
  var result = [];
  for (var i = 0; i < nums.length; i++) {
    result.push(nums[i] * 2);
  }
  return result;
}

var stats = calculateStats(numbers);
var sum = stats.sum;
var average = stats.average;
```

### æ–¹æ¡ˆ3: ç»„åˆ Babel + ESBuild
```javascript
// ä½¿ç”¨ Babel å¤„ç† ES5 è½¬æ¢ï¼ŒESBuild å¤„ç†æ‰“åŒ…
// 1. Babel è½¬æ¢ ES6+ â†’ ES5
// 2. ESBuild å¿«é€Ÿæ‰“åŒ…
```

## ğŸ“Š ESBuild æ”¯æŒçš„ç›®æ ‡ç‰ˆæœ¬

| ç›®æ ‡ç‰ˆæœ¬ | æ”¯æŒçŠ¶æ€ | è¯´æ˜ |
|----------|----------|------|
| ES5 | âŒ ä¸æ”¯æŒ | æ— æ³•è½¬æ¢ç°ä»£è¯­æ³• |
| ES2015 | âš ï¸ éƒ¨åˆ†æ”¯æŒ | æŸäº›ç‰¹æ€§ä¸æ”¯æŒ |
| ES2017 | âœ… æ”¯æŒ | æ¨èçš„æœ€ä½ç‰ˆæœ¬ |
| ES2020+ | âœ… å®Œå…¨æ”¯æŒ | ç°ä»£æµè§ˆå™¨ç›®æ ‡ |

## ğŸ” å®é™…æ¼”ç¤ºå¯¹æ¯”

### ä¿®å¤å‰çš„é…ç½®ï¼ˆä¼šæŠ¥é”™ï¼‰
```javascript
{
  target: ['es5'],          // âŒ ä¼šå¤±è´¥
  entryPoints: ['src/index.js'] // åŒ…å«ç°ä»£è¯­æ³•
}
```

### ä¿®å¤åçš„é…ç½®ï¼ˆæˆåŠŸï¼‰
```javascript
{
  target: ['es2017'],       // âœ… æˆåŠŸ
  entryPoints: ['src/index.js']
}

// æˆ–ä½¿ç”¨ ES5 å…¼å®¹çš„æºç 
{
  target: ['es5'],          // âœ… æˆåŠŸ
  entryPoints: ['src/es5-compatible.js'] // ES5 è¯­æ³•
}
```

## ğŸ’¡ å­¦ä¹ è¦ç‚¹

### ESBuild çš„è®¾è®¡å“²å­¦
1. **é€Ÿåº¦ä¼˜å…ˆ**: ç‰ºç‰²ä¸€äº›å…¼å®¹æ€§æ¢å–æè‡´é€Ÿåº¦
2. **ç°ä»£æµè§ˆå™¨**: ä¸»è¦é’ˆå¯¹ç°ä»£æµè§ˆå™¨ç¯å¢ƒ
3. **ç®€å•é…ç½®**: é¿å…å¤æ‚çš„è½¬æ¢è§„åˆ™

### ä½•æ—¶é€‰æ‹© ESBuild vs Babel

**é€‰æ‹© ESBuild**:
- âœ… ç›®æ ‡ç¯å¢ƒæ˜¯ç°ä»£æµè§ˆå™¨ (ES2017+)
- âœ… è¿½æ±‚æè‡´æ„å»ºé€Ÿåº¦
- âœ… é¡¹ç›®ä½¿ç”¨ç°ä»£ JavaScript è¯­æ³•

**é€‰æ‹© Babel**:
- âœ… éœ€è¦æ”¯æŒ ES5 æˆ–æ›´è€çš„æµè§ˆå™¨
- âœ… éœ€è¦å¤æ‚çš„è¯­æ³•è½¬æ¢
- âœ… ä½¿ç”¨å®éªŒæ€§çš„ JavaScript ç‰¹æ€§

**ç»„åˆä½¿ç”¨**:
- âœ… Babel å¤„ç†è¯­æ³•è½¬æ¢
- âœ… ESBuild å¤„ç†å¿«é€Ÿæ‰“åŒ…

## ğŸ› ï¸ å®ç”¨å»ºè®®

### 1. æ¸è¿›å¼é‡‡ç”¨
```javascript
// å¼€å‘ç¯å¢ƒï¼šç°ä»£è¯­æ³• + å¿«é€Ÿæ„å»º
const devConfig = {
  target: ['es2020'],
  minify: false,
  sourcemap: true
};

// ç”Ÿäº§ç¯å¢ƒï¼šå…¼å®¹æ€§ + ä¼˜åŒ–
const prodConfig = {
  target: ['es2017'],
  minify: true,
  sourcemap: false
};
```

### 2. ç›®æ ‡ç¯å¢ƒæ£€æµ‹
```javascript
// æ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©ç›®æ ‡
const targets = {
  modern: ['es2020', 'chrome90'],      // ç°ä»£åº”ç”¨
  compatible: ['es2017'],              // å…¼å®¹åº”ç”¨  
  legacy: ['es2015']                   // é—ç•™æ”¯æŒ
};
```

### 3. é”™è¯¯å¤„ç†
```javascript
try {
  await build(config);
} catch (error) {
  if (error.message.includes('not supported yet')) {
    console.log('ğŸ’¡ æç¤º: å°è¯•ä½¿ç”¨æ›´é«˜çš„ target ç‰ˆæœ¬');
    console.log('   ä¾‹å¦‚: target: ["es2017"] æˆ– ["es2020"]');
  }
}
```

## ğŸ¯ æ€»ç»“

è¿™æ¬¡ä¿®å¤å±•ç¤ºäº†ï¼š

1. **ESBuild çš„é™åˆ¶**: æ— æ³•å¤„ç†æ‰€æœ‰è¯­æ³•åˆ° ES5 çš„è½¬æ¢
2. **å®ç”¨çš„è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨åˆé€‚çš„ç›®æ ‡ç‰ˆæœ¬
3. **å­¦ä¹ æœºä¼š**: ç†è§£æ„å»ºå·¥å…·çš„æƒè¡¡å–èˆ

é€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œä½ ç°åœ¨æ›´æ·±å…¥åœ°ç†è§£äº†ï¼š
- ESBuild çš„è®¾è®¡ç›®æ ‡å’Œé™åˆ¶
- å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ„å»ºç›®æ ‡
- ç°ä»£æ„å»ºå·¥å…·çš„æƒè¡¡è€ƒè™‘

è¿™æ­£æ˜¯å­¦ä¹ æ„å»ºå·¥å…·çš„ä»·å€¼æ‰€åœ¨ - ä¸ä»…è¦çŸ¥é“å¦‚ä½•ä½¿ç”¨ï¼Œæ›´è¦ç†è§£ä½•æ—¶ä½¿ç”¨ä»¥åŠä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼ğŸš€
